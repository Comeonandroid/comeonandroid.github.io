{"version":3,"file":"public/javascripts/app.js","sources":["app/initialize.coffee"],"names":[],"mappings":"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","sourcesContent":["\nhtmlEscapes = {\n  '&': '&amp;',\n  '<': '&lt;',\n  '>': '&gt;',\n  '\"': '&quot;',\n  \"'\": '&#x27;',\n  '/': '&#x2F;'\n};\n\nhtmlEscaper = /[&<>\"'\\/]/g\n\n_.escape = (string) ->\n  return ('' + string).replace(htmlEscaper, (match) ->\n    return htmlEscapes[match];\n)\n\n\n\npageId = 0\n\nmonthText = ['января','февраля','марта','апреля','мая','июня','июля','августа','сентября','октября','ноября','декабря']\n\ngetCookie = (name)->\n  matches = document.cookie.match(new RegExp(\n    \"(?:^|; )\" + name.replace(/([\\.$?*|{}\\(\\)\\[\\]\\\\\\/\\+^])/g, '\\\\$1') + \"=([^;]*)\"\n  ))\n  if matches then return decodeURIComponent(matches[1]) else return undefined\n\nshowBullshits = (container,data) ->\n  console.log pageId\n  for key,value of data\n    date    = new Date(value.date)\n    year    = date.getFullYear()\n    month   = monthText[date.getMonth()]\n    day     = date.getDate()\n    hours   = date.getHours()\n    minutes = date.getMinutes()\n\n    str = value.text\n    reg =  /(([a-z]+:\\/\\/(www\\.)*)*[a-z0-9\\-_]+\\.[a-z]+[a-z0-9\\.\\/\\-_=\\?\\!\\&;#%\\$\\(\\)]*)/igm;\n    pregMatch = str.match(reg);\n\n    value.text = str.replace(reg, (s) ->\n      msg = if /:\\/\\//.exec(s) is null then \"http://\" + s else s\n      s = s.replace(new RegExp(\"http://\",'i'),'').replace(new RegExp(\"www.\",'i'),'')\n      if s.length > 20\n        s = s.slice(0,20) + '...'\n      return \"<a target=\\\"_blank\\\" href=\\\"#{msg}\\\">#{s}</a>\"\n    )\n\n    dateFormat = day + ' ' + month + ' ' + year + ' / ' + hours + ':' + minutes\n    url = window.location.origin + \"/bullshit/\" + value._id\n\n    society = \"<a href=\\\"http://vkontakte.ru/share.php?url=#{url}&title=Bullshit Board&image=http://zbs-bs.ru/img/VK.png&description=#{_.escape(value.text)}\\\" target=\\\"_blank\\\">Вконтакте</a> / <a target=\\\"_blank\\\" href=\\\"http://www.facebook.com/sharer/sharer.php?u=#{url}&t=asdas\\\">Фейсбук</a> / <a href=\\\"https://twitter.com/intent/tweet?text=Bullshit Board. #{_.escape(value.text)}&url=#{url}\\\" rel=\\\"nofollow\\\" target=\\\"_blank\\\">Твиттер</a>\"\n\n    if getCookie('admin') is 'IDKFA'\n      society += \" / <span class='wow_del_bullshit' data-id='#{value._id}'>Участковому</span>/ ip: #{value.ip}\"\n\n    rotate = Math.random() * (0.3 - (-0.3)) + -0.3\n\n    container.append(\"<div class='bullshit' style='transform: rotate(#{rotate}deg); -webkit-transform: rotate(#{rotate}deg);-moz-transform: rotate(#{rotate}deg);-o-transform: rotate(#{rotate}deg);-ms-transform: rotate(#{rotate}deg) ;'><div class='such_bullshit_message'>#{value.text}</div><div class='many_footer'>[ #{dateFormat} ] рассказать об этом: #{society}</div></div>\")\n\n\n\n$.get \"/bullshits/#{pageId}\", (data)->\n  showBullshits($('.very_bullshit_container'),data)\n\n\n\n\n$('body').on 'keyup','.very_search_input', (e)->\n  e.preventDefault()\n  if e.which is 13\n    $('.wow_publish').click()\n    return false\n  else\n    $(@).height($(@).height() + $(@).scrollTop())\n    text = $(@).val()\n    if text.length > 2 and text.length < 400\n      $.get \"/bullshits/search/#{text}\", (data)->\n        if(data.length > 0)\n          $('.very_bullshit_search_container').html('')\n          showBullshits($('.very_bullshit_search_container'),data)\n          $('.so_sorry').hide()\n        else\n          $('.very_bullshit_search_container').html('')\n          $('.so_sorry').show()\n    else if text.length > 400\n      $(@).val(text.slice 0,400)\n      alert('Помни, краткость сестра таланта')\n    else if text.length < 2\n      $('.very_bullshit_search_container').html('')\n      $('.so_sorry').hide()\n\n$('body').on 'click','.wow_show_about', (e)->\n  e.preventDefault();\n  $(@).css 'opacity',0\n  $('.about').css 'left','0px'\n  $('.main').css 'left','335px'\n  $('body').css 'overflow','hidden'\n\n$('body').on 'click','.wow_hide_about', (e)->\n  e.preventDefault();\n  $('.wow_show_about').css 'opacity',1\n  $('.about').css {left:'-335px'}\n  $('.main').css 'left','0px'\n  $('body').css 'overflow','auto'\n\n\n$('body').on 'click','.wow_show_search', (e)->\n  e.preventDefault();\n  $('.wow_wrapper.search').fadeIn(600)\n  $('.wow_wrapper.main').fadeOut(500)\n  $('.wow_wrapper.main div').fadeOut(500)\n  $(\".wow_wrapper.search div[class != 'so_sorry']\").fadeIn(600)\n  $('textarea').focus()\n  $('.very_bullshit_search_container').html('')\n\n\n$('body').on 'click','.wow_hide_search', (e)->\n  e.preventDefault();\n  $('.wow_wrapper.search').fadeOut(600)\n  $('.wow_wrapper.main').fadeIn(600)\n  $('.wow_wrapper.main div').fadeIn(600)\n  $('.wow_wrapper.search div').fadeOut(600)\n\n$('body').on 'click','.wow_publish', (e)->\n  e.preventDefault()\n\n  input = $(this).parent().find('.very_search_input')\n  input.css 'text-transform', 'none'\n  text = input.val()\n  input.css 'text-transform', 'uppercase'\n  if text.length < 2 then return false\n\n  $.post '/bullshit',{text: text}, (data)->\n    if data.status is 'success'\n      $('.very_bullshit_container').html('')\n      pageId = 0\n      $.get \"/bullshits/#{pageId}\", (data)->\n        $('.very_bullshit_container').html('')\n        showBullshits($('.very_bullshit_container'),data)\n      input.val('');\n      $('.wow_wrapper.search').fadeOut(600)\n      $('.wow_wrapper.main').fadeIn(600)\n      $('.wow_wrapper.main div').fadeIn(600)\n      $('.wow_wrapper.search div').fadeOut(600)\n\n$('body').on 'click','.wow_del_bullshit', (e)->\n  id = $(@).attr('data-id')\n  bullshit = $(@).parents('.bullshit')\n  $.ajax({\n    url: \"/bullshit/#{id}\",\n    type: 'DELETE',\n    success: (result) ->\n      bullshit.remove()\n  })\n\n$(document).scroll (e)->\n  if $(window).height() + $(window).scrollTop() > $(document).height() - 300\n    pageId++\n    console.log pageId\n    $.get \"/bullshits/#{pageId}\", (data)->\n      showBullshits($('.very_bullshit_container'),data)\n\ndate    = new Date()\nyear    = date.getFullYear()\nmonth   = monthText[date.getMonth()]\nday     = date.getDate()\nhours   = date.getHours()\nminutes = date.getMinutes() + ''\nminutes = if minutes.length > 1 then minutes else '0'+minutes\n\ndateFormat = day + ' ' + month + ' ' + year + '<span class=\"so_time_span\"> / ' + hours + '<span class=\"blink\">:</span>' + minutes+'</span>'\n\n$('.very_date').html(dateFormat)\n\n\nif bullshit?\n  value = bullshit\n\n  date    = new Date(value.date)\n  year    = date.getFullYear()\n  month   = monthText[date.getMonth()]\n  day     = date.getDate()\n  hours   = date.getHours()\n  minutes = date.getMinutes()\n\n  str = value.text\n  reg =  /(([a-z]+:\\/\\/(www\\.)*)*[a-z0-9\\-_]+\\.[a-z]+[a-z0-9\\.\\/\\-_=\\?\\!\\&;#%\\$\\(\\)]*)/igm;\n  pregMatch = str.match(reg);\n\n  value.text = str.replace(reg, (s) ->\n    msg = if /:\\/\\//.exec(s) is null then \"http://\" + s else s\n    return \"<a target=\\\"_blank\\\" href=\\\"#{msg}\\\">#{s}</a>\"\n  )\n\n  dateFormat = day + ' ' + month + ' ' + year + ' / ' + hours + ':' + minutes\n  url = window.location.origin + \"/bullshit/\" + value._id\n\n  society = \"<a href=\\\"http://vkontakte.ru/share.php?url=#{url}&title=Bullshit Board&image=http://zbs-bs.ru/img/VK.png&description=#{_.escape(value.text)}\\\" target=\\\"_blank\\\">Вконтакте</a> / <a target=\\\"_blank\\\" href=\\\"http://www.facebook.com/sharer/sharer.php?u=#{url}&t=asdas\\\">Фейсбук</a> / <a href=\\\"https://twitter.com/intent/tweet?text=Bullshit Board. #{_.escape(value.text)}&url=#{url}\\\" rel=\\\"nofollow\\\" target=\\\"_blank\\\">Твиттер</a>\"\n\n\n  if getCookie('admin') is 'IDKFA'\n    society += \" / <span class='wow_del_bullshit' data-id='#{value._id}'>Участковому</span>\"\n\n  rotate = Math.random() * (0.3 - (-0.3)) + -0.3\n  $('.very_bullshit_search_container').append(\"<div class='bullshit' style='transform: rotate(#{rotate}deg); -webkit-transform: rotate(#{rotate}deg);-moz-transform: rotate(#{rotate}deg);-o-transform: rotate(#{rotate}deg);-ms-transform: rotate(#{rotate}deg) ;'><div class='such_bullshit_message'>#{value.text}</div><div class='many_footer'>[ #{dateFormat} ] рассказать об этом: #{society}</div></div>\")\n"]}